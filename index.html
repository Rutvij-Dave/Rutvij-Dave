<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Rutvij Dave â€” Senior Data Engineer</title>

<!-- Favicon (SVG Data URI) -->
<link rel="icon" href="data:image/svg+xml;utf8,
<svg xmlns='http://www.w3.org/2000/svg' width='64' height='64' viewBox='0 0 64 64'>
  <defs><linearGradient id='g' x1='0' x2='1'><stop offset='0' stop-color='%2338bdf8'/><stop offset='1' stop-color='%23818cf8'/></linearGradient></defs>
  <rect width='64' height='64' rx='12' fill='%230f172a'/>
  <text x='50%' y='54%' font-size='28' font-family='Poppins, sans-serif' fill='url(%23g)' text-anchor='middle' font-weight='700'>RD</text>
</svg>" />

<meta name="description" content="Rutvij Dave â€” Senior Data Engineer. Cloud & Big Data specialist (AWS, Snowflake). Portfolio & projects." />
<meta property="og:title" content="Rutvij Dave â€” Data Engineer" />
<meta property="og:description" content="Building scalable data platforms, ETL pipelines & analytics systems." />
<meta property="og:type" content="website" />

<!-- Fonts & external libs -->
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;700;900&display=swap" rel="stylesheet">
<script src="https://unpkg.com/three@0.152.2/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.152.2/examples/js/controls/OrbitControls.js"></script>
<script src="https://unpkg.com/gsap@3.12.2/dist/gsap.min.js"></script>

<style>
:root{
  --bg:#07071a;
  --card:#0f1726;
  --muted:#9aa7bd;
  --accent1:#38bdf8;
  --accent2:#818cf8;
  --glass: rgba(255,255,255,0.03);
  --glass-2: rgba(255,255,255,0.02);
}

/* === Reset === */
*{box-sizing:border-box}
html,body{height:100%;margin:0;font-family:'Poppins',system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;color:#e6eef8;background:var(--bg);-webkit-font-smoothing:antialiased}
a{color:inherit}

/* === Loader (improved) === */
#loader{
  position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#020318 0,#071029 100%);z-index:99999;flex-direction:column;
  transition:opacity .6s, visibility .6s;
}
.logo-anim{
  width:92px;height:92px;border-radius:20px;background:linear-gradient(135deg,var(--accent1),var(--accent2));display:flex;align-items:center;justify-content:center;font-weight:900;color:#071028;font-size:26px;
  box-shadow:0 12px 40px rgba(56,189,248,.08), inset 0 3px 10px rgba(255,255,255,.02);
}
.load-caption{margin-top:16px;color:var(--muted)}

/* subtle floating blobs behind everything */
.blob{
  position:fixed;pointer-events:none;border-radius:50%;filter:blur(80px) saturate(120%);opacity:.14;z-index:0;
}
.blob.a{width:640px;height:640px;left:-12%;top:6%;background:radial-gradient(circle,var(--accent1),transparent 45%)}
.blob.b{width:480px;height:480px;right:-10%;bottom:6%;background:radial-gradient(circle,var(--accent2),transparent 45%);opacity:.12}

/* WebGL canvas layer (keeps pointer-events none so UI remains interactive) */
#hero-canvas{position:fixed;inset:0;z-index:0;pointer-events:none}

/* tiny nav underline animation */
.header{position:fixed;top:18px;left:0;right:0;display:flex;justify-content:space-between;align-items:center;padding:0 6%;z-index:60}
.brand{font-weight:800;letter-spacing:.4px}
.nav{display:flex;gap:18px;align-items:center}
.nav a{color:rgba(230,238,248,.95);text-decoration:none;padding:8px 12px;border-radius:8px;font-weight:600;position:relative;transition:all .18s}
.nav a::after{content:"";position:absolute;left:12px;right:12px;height:2px;bottom:-8px;background:linear-gradient(90deg,var(--accent1),var(--accent2));opacity:0;transform:scaleX(.2);transform-origin:left;transition:all .22s}
.nav a:hover::after{opacity:1;transform:scaleX(1)}
.toggle{padding:8px 12px;border-radius:10px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:var(--muted);cursor:pointer}

/* custom cursor + tiny trailing dots */
.cursor{position:fixed;pointer-events:none;width:26px;height:26px;border-radius:50%;z-index:2000;transform:translate(-50%,-50%);mix-blend-mode:screen;background:radial-gradient(circle, rgba(56,189,248,.95), rgba(56,189,248,.25) 25%, transparent 45%);transition:transform .08s ease,width .12s ease;height .12s,opacity .12s}
.trail{position:fixed;pointer-events:none;width:8px;height:8px;border-radius:50%;background:rgba(56,189,248,.85);filter:blur(8px);opacity:.9;transform:translate(-50%,-50%);z-index:1900;transition:opacity .35s}

/* hero */
.hero{position:relative;min-height:86vh;display:flex;align-items:center;justify-content:center;padding:8vh 6%;text-align:center;z-index:2}
.kicker{display:inline-block;padding:6px 12px;border-radius:999px;background:linear-gradient(90deg, rgba(56,189,248,.06), rgba(129,140,248,.04));color:var(--accent1);font-weight:700;margin-bottom:18px;font-size:13px}
.h1{font-size:clamp(36px,7vw,84px);line-height:1;margin:0;background:linear-gradient(90deg,var(--accent1),var(--accent2));-webkit-background-clip:text;-webkit-text-fill-color:transparent;font-weight:900}
.h2{color:var(--muted);margin-top:12px;font-size:18px}

/* CTA */
.cta{margin-top:28px;display:inline-flex;gap:12px}
.btn{padding:12px 18px;border-radius:12px;font-weight:700;background:linear-gradient(90deg, rgba(56,189,248,.08), rgba(129,140,248,.06));border:1px solid rgba(255,255,255,0.04);color:#e8f9ff;text-decoration:none}
.btn:hover{transform:translateY(-6px);box-shadow:0 20px 56px rgba(56,189,248,.06)}

/* intro card */
.intro{margin-top:40px;background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));padding:18px;border-radius:12px;display:flex;gap:18px;align-items:center;justify-content:center;max-width:920px;margin-left:auto;margin-right:auto}
.meta p{margin:0;color:var(--muted)}

/* layout sections */
section{padding:96px 6%;position:relative;z-index:2}
.section-title{font-weight:800;font-size:28px;margin-bottom:18px}
.two-col{display:grid;grid-template-columns:1fr 420px;gap:30px;align-items:start}
@media(max-width:880px){.two-col{grid-template-columns:1fr}}

/* skills / bars */
.skills{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:16px}
.skill{padding:14px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.03)}
.skill h4{margin:0 0 10px 0}
.bar{height:12px;background:rgba(0,0,0,0.25);border-radius:999px;overflow:hidden}
.fill{height:100%;width:0;background:linear-gradient(90deg,var(--accent1),var(--accent2));border-radius:999px;}

/* projects */
.projects-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(260px,1fr));gap:22px}
.project{padding:18px;border-radius:12px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.03);transition:transform .36s,box-shadow .36s;position:relative;overflow:hidden}
.project:hover{transform:translateY(-10px);box-shadow:0 30px 80px rgba(2,6,23,0.6)}
.project .spot{position:absolute;left:50%;top:50%;width:280px;height:280px;margin-left:-140px;margin-top:-140px;border-radius:50%;pointer-events:none;mix-blend-mode:screen;filter:blur(40px);opacity:0;transition:opacity .28s, transform .28s}
.project:hover .spot{opacity:.9}

/* modal */
.modal{position:fixed;inset:0;display:flex;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);visibility:hidden;opacity:0;transition:opacity .24s;z-index:3000;padding:24px}
.modal.show{visibility:visible;opacity:1}
.panel{width:100%;max-width:980px;background:#071226;padding:20px;border-radius:12px;border:1px solid rgba(255,255,255,0.04)}

/* reveal utility */
.reveal{opacity:0;transform:translateY(24px);transition:all .9s cubic-bezier(.2,.9,.2,1)}
.reveal.show{opacity:1;transform:translateY(0)}

/* tiny responsive */
@media(max-width:640px){
  .nav{gap:10px}.kicker{font-size:12px}.h1{font-size:34px}
}
</style>
</head>
<body>

<!-- Loader -->
<div id="loader" role="status" aria-hidden="false">
  <div class="logo-anim">RD</div>
  <div class="load-caption">Booting flagship experienceâ€¦</div>
</div>

<!-- decorative blobs -->
<div class="blob a" aria-hidden="true"></div>
<div class="blob b" aria-hidden="true"></div>

<!-- WebGL canvas -->
<canvas id="hero-canvas" aria-hidden="true"></canvas>

<!-- cursor aura + trail container -->
<div class="cursor" id="cursor" aria-hidden="true"></div>
<div id="trail-root" aria-hidden="true"></div>

<!-- header -->
<header class="header" role="banner">
  <div class="brand">Rutvij <span style="opacity:.7">Dave</span></div>
  <nav class="nav" role="navigation" aria-label="primary">
    <a href="#about">About</a>
    <a href="#skills">Skills</a>
    <a href="#projects">Projects</a>
    <a href="#contact">Contact</a>
    <button class="toggle" id="perfToggle" title="Toggle performance mode">Perf: Full</button>
  </nav>
</header>

<!-- main -->
<main>
  <section class="hero" id="home" aria-labelledby="hero-title">
    <div class="hero-inner">
      <div class="kicker">Senior Data Engineer â€¢ Cloud & Big Data</div>
      <h1 class="h1" id="hero-title">I build <span id="type">scalable data platforms</span></h1>
      <p class="h2">Production ETL & orchestration â€¢ Snowflake data warehousing â€¢ AWS cloud infrastructure</p>

      <div class="cta">
        <a class="btn" href="#projects">See Projects</a>
        <a class="btn" href="#contact">Contact</a>
        <a class="btn" id="audioToggle" href="#" title="Enable sound reactive demo">Enable Sound</a>
      </div>

      <div class="intro" aria-label="Snapshot">
        <div class="meta">
          <h3 style="margin:0 0 6px 0">Snapshot</h3>
          <p style="color:var(--muted);margin:0">7+ years experience â€¢ 5+ years in Data Engineering â€¢ AWS â€¢ Snowflake â€¢ ETL/ELT â€¢ Data Modeling â€¢ Orchestration</p>
        </div>
      </div>
    </div>
  </section>

  <!-- About & quick CTA -->
  <section id="about" class="reveal">
    <div class="two-col">
      <div>
        <div class="section-title">About</div>
        <p style="color:var(--muted)">I design and build large-scale data platforms using AWS and Snowflake. My focus is on reliable ETL, observability, automation, and delivering analytics-ready warehouses that power business decisions.</p>
        <div style="margin-top:18px">
          <a class="btn" href="#contact">Let's Talk</a>
        </div>
      </div>
      <div>
        <div style="border-radius:12px;padding:18px;background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.02));border:1px solid rgba(255,255,255,0.03)">
          <h4 style="margin:0 0 8px 0">Contact</h4>
          <p style="color:var(--muted);margin:0">ðŸ“ž +91 884 9214 912<br>ðŸ“§ <a href="mailto:your@email.com" style="color:var(--accent1)">your@email.com</a></p>
        </div>
      </div>
    </div>
  </section>

  <!-- Skills -->
  <section id="skills" class="reveal">
    <div class="section-title">Skills & Tools</div>
    <div class="skills">
      <div class="skill"><h4>AWS â€” Cloud Platforms</h4><div class="bar"><div class="fill" data-w="90%"></div></div></div>
      <div class="skill"><h4>Snowflake â€” Data Warehousing</h4><div class="bar"><div class="fill" data-w="85%"></div></div></div>
      <div class="skill"><h4>SQL â€” Data Engineering</h4><div class="bar"><div class="fill" data-w="92%"></div></div></div>
      <div class="skill"><h4>Data Engineering â€” Pipelines & Modeling</h4><div class="bar"><div class="fill" data-w="95%"></div></div></div>
    </div>
  </section>

  <!-- Projects -->
  <section id="projects" class="reveal">
    <div class="section-title">Selected Projects</div>
    <div class="projects-grid">
      <article class="project" tabindex="0" data-title="Enterprise Warehouse" data-desc="Designed and implemented Snowflake architecture with dimensional models and performance tuning.">
        <div class="spot" style="background:radial-gradient(circle, rgba(56,189,248,.45), rgba(129,140,248,.12));"></div>
        <div class="tag">Snowflake</div>
        <h3>Enterprise Warehouse</h3>
        <p style="color:var(--muted)">Optimized data models & delivered analytics-ready marts.</p>
        <div style="margin-top:12px"><button class="btn" onclick="openModal(this)">Preview</button></div>
      </article>

      <article class="project" tabindex="0" data-title="Pipeline Framework" data-desc="Automated multi-source ETL pipelines with orchestration, retries, and monitoring.">
        <div class="spot" style="background:radial-gradient(circle, rgba(129,140,248,.45), rgba(56,189,248,.12));"></div>
        <div class="tag">ETL</div>
        <h3>Pipeline Framework</h3>
        <p style="color:var(--muted)">Resilient ingestion with schema evolution handling and alerts.</p>
        <div style="margin-top:12px"><button class="btn" onclick="openModal(this)">Preview</button></div>
      </article>

      <article class="project" tabindex="0" data-title="Analytics Platform" data-desc="Developed analytic models and dashboards for near real-time KPIs.">
        <div class="spot" style="background:radial-gradient(circle, rgba(56,189,248,.45), rgba(129,140,248,.12));"></div>
        <div class="tag">Analytics</div>
        <h3>Analytics Platform</h3>
        <p style="color:var(--muted)">Aggregation layers & serving tables for BI tools.</p>
        <div style="margin-top:12px"><button class="btn" onclick="openModal(this)">Preview</button></div>
      </article>
    </div>
  </section>

  <!-- Contact -->
  <section id="contact" class="reveal">
    <div class="section-title">Contact</div>
    <p style="color:var(--muted)">Interested in collaborating? Reach out â€” I respond quickly.</p>
    <p style="color:var(--muted)">ðŸ“ž +91 884 9214 912 â€¢ ðŸ“§ <a href="mailto:your@email.com" style="color:var(--accent1)">your@email.com</a></p>
  </section>
</main>

<!-- modal -->
<div id="modal" class="modal" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="panel">
    <button class="close" onclick="closeModal()" aria-label="Close modal" style="float:right;background:transparent;border:0;color:var(--muted);font-weight:700">âœ•</button>
    <h3 id="modal-title"></h3>
    <p id="modal-desc" style="color:var(--muted)"></p>
    <div style="margin-top:16px"><a class="btn" href="#contact">Contact about this project</a></div>
  </div>
</div>

<footer class="footer">Â© Rutvij Dave â€” Built with engineering & motion</footer>

<script>
/* -----------------------------
   Helpers
   ----------------------------- */
const $ = s => document.querySelector(s);
const $$ = s => Array.from(document.querySelectorAll(s));

/* Loader safety: always auto-hide after 3s even if something fails */
window.addEventListener('load', ()=> {
  setTimeout(()=> {
    const l = $('#loader');
    if(l){ l.style.opacity = 0; l.style.visibility = 'hidden'; }
    // trigger important UI animations
    revealOnScroll(true);
    animateHeroType();
    animateCountersAndBars();
    entranceShow();
  }, 420);
});
setTimeout(()=>{ const l = $('#loader'); if(l){ l.style.opacity = 0; l.style.visibility = 'hidden'; } }, 3000);

/* Cursor + small DOM trail for charm (lightweight) */
const cursor = $('#cursor');
const trailRoot = document.getElementById('trail-root');
let trailPool = [];
function spawnTrail(x,y){
  let el = trailPool.pop();
  if(!el){
    el = document.createElement('div');
    el.className = 'trail';
    document.body.appendChild(el);
  }
  el.style.left = x + 'px';
  el.style.top = y + 'px';
  el.style.opacity = '1';
  // fade then recycle
  gsap.to(el, {opacity:0, scale:0.4, duration:0.9, onComplete: ()=>{ el.style.transform=''; trailPool.push(el); }});
}
document.addEventListener('mousemove', (e)=>{
  cursor.style.left = e.clientX + 'px';
  cursor.style.top = e.clientY + 'px';
  spawnTrail(e.clientX - 6, e.clientY - 6);
});

/* reveal entrance - small staggered entrance for hero content */
function entranceShow(){
  gsap.from('.brand', {y:-6, opacity:0, duration:.6});
  gsap.from('.kicker', {y:8, opacity:0, duration:.7, delay:.08});
  gsap.from('#hero-title', {y:24, opacity:0, duration:.9, delay:.14, ease:'expo.out'});
  gsap.from('.h2', {y:20, opacity:0, duration:.9, delay:.22});
}

/* Typewriter (hero) */
function animateHeroType(){
  const el = document.getElementById('type');
  if(!el) return;
  const words = ['scalable data platforms','cloud architectures','reliable data pipelines','analytics-ready models'];
  let w=0,i=0,deleting=false;
  function tick(){
    const word = words[w];
    el.textContent = word.slice(0,i);
    if(!deleting) i++; else i--;
    if(!deleting && i === word.length){ deleting=true; setTimeout(tick,1200); return; }
    if(deleting && i === 0){ deleting=false; w=(w+1)%words.length; }
    setTimeout(tick, deleting?40:80);
  }
  tick();
}

/* revealOnScroll + animate bars */
function revealOnScroll(initial=false){
  const reveals = $$('.reveal');
  reveals.forEach(r=>{
    const rect = r.getBoundingClientRect();
    if(rect.top < window.innerHeight - 100){
      r.classList.add('show');
      // animate skill fills inside (GSAP)
      r.querySelectorAll('.fill').forEach((f,i)=>{
        const w = f.getAttribute('data-w') || f.style.getPropertyValue('--w') || '70%';
        gsap.to(f, {width: w, duration: 1.6, delay: 0.2 + i*0.12, ease: "power3.out"});
      });
    } else if(initial===false){
      r.classList.remove('show');
    }
  });
}
window.addEventListener('scroll', revealOnScroll);

/* animate counters (if you want numbers later) and bars prepping */
function animateCountersAndBars(){
  // sample counter for years (example: not in DOM by default)
  // animate skill bars in view (just in case)
  $$('.fill').forEach((f,i)=>{
    const w = f.getAttribute('data-w') || f.style.getPropertyValue('--w') || '75%';
    gsap.to(f, {width:w, duration:1.6, delay:0.2 + i*0.12, ease:'power3.out'});
  });
}

/* Modal preview */
function openModal(btn){
  const article = btn.closest('.project');
  const title = article.dataset.title || article.querySelector('h3').innerText;
  const desc = article.dataset.desc || article.querySelector('p').innerText;
  $('#modal-title').innerText = title;
  $('#modal-desc').innerText = desc;
  const modal = $('#modal'); modal.classList.add('show'); modal.setAttribute('aria-hidden','false');
}
function closeModal(){ const modal = $('#modal'); modal.classList.remove('show'); modal.setAttribute('aria-hidden','true'); }
document.addEventListener('keydown', e=> { if(e.key === 'Escape') closeModal(); });

/* Magnetic tilt for project cards (GSAP eased) with spotlight movement */
$$('.project').forEach(card=>{
  // create small spotlight element if missing
  const spot = card.querySelector('.spot');
  card.addEventListener('mousemove', e=>{
    const rect = card.getBoundingClientRect();
    const rx = (e.clientX - rect.left) / rect.width;
    const ry = (e.clientY - rect.top) / rect.height;
    const px = (rx - 0.5) * 12;
    const py = (ry - 0.5) * -12;
    gsap.to(card, {duration:0.6, rotateX:py, rotateY:px, scale:1.02, ease:'power3.out', transformOrigin:'center'});
    if(spot){
      const sx = (rx * rect.width);
      const sy = (ry * rect.height);
      gsap.to(spot, {left: sx+'px', top: sy+'px', xPercent:-50, yPercent:-50, duration:0.28, ease:'power2.out'});
      gsap.to(spot, {opacity:0.95, duration:0.18});
    }
  });
  card.addEventListener('mouseleave', ()=> { gsap.to(card, {duration:0.6, rotateX:0, rotateY:0, scale:1, ease:'power3.out'}); if(card.querySelector('.spot')) gsap.to(card.querySelector('.spot'), {opacity:0, duration:0.38}); });
});

/* Performance toggle - uses window.particles API if present */
let heavy = true;
$('#perfToggle').addEventListener('click', (e)=>{
  heavy = !heavy;
  $('#perfToggle').textContent = heavy ? 'Perf: Full' : 'Perf: Lite';
  if(window.particles) window.particles.setEnabled(heavy);
});

/* Audio reactive mic toggle (opt-in) */
let audioCtx, analyser, micStream;
$('#audioToggle').addEventListener('click', async (e)=>{
  e.preventDefault();
  if($('#audioToggle').dataset.active === '1'){
    $('#audioToggle').dataset.active = '0';
    $('#audioToggle').textContent = 'Enable Sound';
    if(micStream) { micStream.getTracks().forEach(t=>t.stop()); micStream = null; }
    if(audioCtx) { audioCtx.close(); audioCtx=null; }
    return;
  }
  try {
    const stream = await navigator.mediaDevices.getUserMedia({audio:true, video:false});
    micStream = stream;
    audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    const source = audioCtx.createMediaStreamSource(stream);
    analyser = audioCtx.createAnalyser();
    analyser.fftSize = 2048;
    source.connect(analyser);
    $('#audioToggle').dataset.active = '1';
    $('#audioToggle').textContent = 'Sound On';
    const data = new Uint8Array(analyser.frequencyBinCount);
    (function read(){
      if(!analyser) return;
      analyser.getByteFrequencyData(data);
      let sum=0; for(let i=0;i<data.length;i++) sum+=data[i];
      const avg = sum / data.length;
      const intensity = Math.min(6, avg / 20);
      if(window.pulseParticles) window.pulseParticles(intensity);
      requestAnimationFrame(read);
    })();
  } catch(err){
    alert('Microphone access denied or not available.');
    console.error(err);
  }
});

/* === Tiny WebGL particle integration (keeps your original, but with a safer fallback) === */
(function createParticles(){
  try {
    const canvas = document.getElementById('hero-canvas');
    const renderer = new THREE.WebGLRenderer({canvas: canvas, antialias: true, alpha: true});
    renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
    renderer.setSize(window.innerWidth, window.innerHeight);
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 1, 2000);
    camera.position.set(0,0,350);
    const PARTICLE_COUNT = 10000;
    const geometry = new THREE.BufferGeometry();
    const positions = new Float32Array(PARTICLE_COUNT * 3);
    const colors = new Float32Array(PARTICLE_COUNT * 3);
    const sizes = new Float32Array(PARTICLE_COUNT);
    for(let i=0;i<PARTICLE_COUNT;i++){
      const phi = Math.random()*Math.PI*2;
      const r = 200 + Math.random()*700;
      positions[i*3]=Math.cos(phi)*r*(0.6 + Math.random()*0.8);
      positions[i*3+1]=Math.sin(phi)*r*(0.6 + Math.random()*0.8);
      positions[i*3+2]=(Math.random()-0.5)*1200;
      const c = (Math.random()*0.6+0.4);
      colors[i*3]=c; colors[i*3+1]=0.9*c; colors[i*3+2]=1*c;
      sizes[i]=1.2 + Math.random()*4.2;
    }
    geometry.setAttribute('position', new THREE.BufferAttribute(positions,3));
    geometry.setAttribute('aColor', new THREE.BufferAttribute(colors,3));
    geometry.setAttribute('size', new THREE.BufferAttribute(sizes,1));

    const material = new THREE.ShaderMaterial({
      transparent: true,
      depthTest: true,
      uniforms: {
        uTime: {value:0},
        uPixelRatio: {value: Math.min(window.devicePixelRatio,2)},
        uMouse: {value: new THREE.Vector2(0,0)},
        uAccent1: {value: new THREE.Color('#38bdf8')},
        uAccent2: {value: new THREE.Color('#818cf8')}
      },
      vertexShader: `
        attribute float size;
        attribute vec3 aColor;
        varying vec3 vColor;
        uniform float uTime;
        void main(){
          vColor = aColor;
          vec3 pos = position;
          float t = uTime * 0.2;
          pos.x += sin(t + position.y * 0.01) * 6.0;
          pos.y += cos(t + position.x * 0.01) * 6.0;
          vec4 mvPosition = modelViewMatrix * vec4(pos, 1.0);
          gl_PointSize = size * (200.0 / -mvPosition.z);
          gl_Position = projectionMatrix * mvPosition;
        }
      `,
      fragmentShader: `
        uniform vec3 uAccent1;
        uniform vec3 uAccent2;
        varying vec3 vColor;
        void main(){
          vec2 coord = gl_PointCoord - vec2(0.5);
          float dist = length(coord);
          float alpha = 1.0 - smoothstep(0.35, 0.5, dist);
          vec3 col = mix(uAccent1, uAccent2, vColor.r);
          gl_FragColor = vec4(col, alpha * 0.9);
        }
      `
    });

    const points = new THREE.Points(geometry, material);
    scene.add(points);

    window.addEventListener('resize', ()=> {
      renderer.setSize(window.innerWidth, window.innerHeight);
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
    });

    const mouse = new THREE.Vector2(0,0);
    document.addEventListener('mousemove', (e)=> {
      mouse.x = (e.clientX / window.innerWidth) * 2 - 1;
      mouse.y = - (e.clientY / window.innerHeight) * 2 + 1;
      material.uniforms.uMouse.value.set(mouse.x, mouse.y);
    });

    const clock = new THREE.Clock();
    let enabled = true;
    function animate(){
      if(enabled){
        material.uniforms.uTime.value = clock.getElapsedTime();
        camera.position.x += (mouse.x * 60 - camera.position.x) * 0.06;
        camera.position.y += (mouse.y * 40 - camera.position.y) * 0.06;
        camera.lookAt(0,0,0);
        renderer.render(scene, camera);
      } else {
        renderer.clear();
      }
      requestAnimationFrame(animate);
    }
    animate();

    window.particles = {
      setEnabled: (v)=> { enabled = !!v; if(!enabled) renderer.clear(); }
    };
    window.pulseParticles = (intensity=1)=> {
      const pos = geometry.attributes.position.array;
      for(let i=0;i<PARTICLE_COUNT;i++){
        pos[i*3] += (Math.random()-0.5) * intensity * 8;
        pos[i*3+1] += (Math.random()-0.5) * intensity * 8;
      }
      geometry.attributes.position.needsUpdate = true;
    };
  } catch(e){
    // If WebGL fails, hide loader anyway and degrade gracefully
    console.warn('Particles failed to initialize', e);
    const l = $('#loader'); if(l){ l.style.opacity = 0; l.style.visibility = 'hidden'; }
  }
})();

/* Safety initial enable for particles */
if(window.particles) window.particles.setEnabled(true);

/* console hint */
console.info('Enhanced portfolio loaded â€” try hover effects, sound mode, and performance toggle.');
</script>
</body>
</html>
